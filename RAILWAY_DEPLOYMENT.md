# Railway Deployment Guide - TermOS LT

## ğŸš€ Quick Start (5 Minutes)

### Option A: Deploy from GitHub (Recommended)

1. **Go to [railway.app](https://railway.app)**
2. **Sign in with GitHub** (authorize access)
3. **Click "New Project"** â†’ **"Deploy from GitHub repo"**
4. **Select** `DaumantasPetrauskas-cloud/termchat-lt`
5. **Railway auto-detects** Dockerfile configuration
6. **Add environment variables** (see below)
7. **Deploy!** ğŸ‰

### Option B: Deploy from CLI

```bash
# Install Railway CLI
npm install -g @railway/cli

# Login to Railway
railway login

# Initialize project in this directory
railway init

# Link to repository
railway link

# Deploy
railway up
```

---

## ğŸ”§ Environment Variables Setup

In Railway dashboard, add these variables:

| Variable | Value | Required |
|----------|-------|----------|
| `ZHIPU_API_KEY` | Your API key | Yes |
| `AI_PROVIDER` | `zhipu` | Yes |
| `PORT` | `10000` (auto-set) | No |
| `MONGODB_URI` | (optional) | No |
| `RENDER` | `false` | No |
| `RAILWAY` | `true` | No |

---

## ğŸ“‹ Deployment Steps

### Step 1: Prepare GitHub
âœ… All code is already on GitHub
âœ… Configuration files included (Dockerfile, railway.json)
âœ… Environment documented

### Step 2: Connect Railway to GitHub
1. Go to [railway.app/dashboard](https://railway.app/dashboard)
2. Click **"New Project"**
3. Select **"Deploy from GitHub repo"**
4. Authorize Railway app (one-time)
5. Select `termchat-lt` repository

### Step 3: Configure Project
1. Railway auto-detects Dockerfile
2. Click **"Add Plugin"** â†’ **"PostgreSQL"** (optional)
3. Click **"Add Plugin"** â†’ **"MongoDB"** (optional)

### Step 4: Set Environment Variables
1. Go to **Project Settings**
2. Click **"Variables"**
3. Add each variable from table above:
   - `ZHIPU_API_KEY` = your-key
   - `AI_PROVIDER` = zhipu
   - `RAILWAY` = true

### Step 5: Deploy
1. Click **"Deploy"** button
2. Watch build logs
3. Wait for green checkmark âœ…

### Step 6: Get Public URL
1. Go to **Deployments** tab
2. Copy the generated domain
3. Format: `https://termchat-xxx.railway.app`

---

## ğŸŒ Your Railway Deployment

Once deployed, your backend will be available at:

```
https://termchat-xxx.railway.app
```

(where `xxx` is auto-generated by Railway)

Update your frontend to point to this URL if needed.

---

## ğŸ”„ How Deployments Work

### First Deploy
- Railway pulls from GitHub
- Builds Docker image
- Installs dependencies
- Starts application
- Generates public URL

### Auto Redeploy
Every time you push to GitHub:
```bash
git push origin main
```

Railway automatically:
1. Detects changes
2. Rebuilds image
3. Deploys new version
4. Restarts service

---

## ğŸ“Š Deployment Status

### Dockerfile
âœ… **Located**: `/workspaces/termchat-lt/Dockerfile`
âœ… **Python 3.11** slim image
âœ… **Health checks** configured
âœ… **Auto-restart** enabled

### railway.json
âœ… **Located**: `/workspaces/termchat-lt/railway.json`
âœ… **Start command** configured
âœ… **Build settings** set

### .dockerignore
âœ… **Located**: `/workspaces/termchat-lt/.dockerignore`
âœ… **Optimized** for build speed
âœ… **No sensitive** files included

---

## ğŸ” Verify Deployment

### Check Status
```
1. Visit Railway dashboard
2. Look for green checkmark on deployment
3. Check "Deployments" tab for build logs
```

### Test Backend
```bash
# Test health check
curl https://termchat-xxx.railway.app/

# Should respond with HTTP 200
```

### Monitor Logs
```
1. Go to Deployments tab
2. Click your deployment
3. View "Logs" section
4. Look for "Connected to MQTT broker"
```

---

## ğŸš¨ Troubleshooting

### Build Failed?
1. Check build logs in Railway dashboard
2. Verify `Dockerfile` syntax
3. Check Python version compatibility
4. Ensure all dependencies in `requirements.txt`

### Health Check Failing?
1. Verify HTTP server running
2. Check PORT environment variable
3. Look at logs for errors
4. Increase health check timeout

### MQTT Connection Issues?
1. Verify `MQTT_BROKER_URL` in code
2. Check network connectivity
3. Confirm broker is accessible from Railway
4. Test with local broker

### Memory/CPU Issues?
1. Upgrade Railway plan
2. Check for memory leaks in logs
3. Optimize conversation history limits
4. Review database queries

---

## ğŸ“ˆ Scaling

### Vertical Scaling (More Power)
- Go to **Project Settings**
- Click **"Pricing"**
- Select higher tier (Pro, Business)
- Restarts automatically

### Horizontal Scaling (More Instances)
- Go to **Deployment Settings**
- Set **"Replicas"** to 2+
- Uses load balancing automatically

### Database Scaling
- Add **PostgreSQL** plugin for persistence
- Add **MongoDB** plugin for complex data
- Railway manages backups automatically

---

## ğŸ” Security

### Best Practices
âœ… **Never commit .env file**  
âœ… **Use Railway environment variables**  
âœ… **Use HTTPS only** (auto-enforced)  
âœ… **Enable authentication** for plugins  
âœ… **Monitor logs** for errors  

### API Keys
- Set `ZHIPU_API_KEY` in Railway dashboard
- Never hardcode in code
- Rotate periodically
- Monitor usage

### Network
- Railway provides DDoS protection
- All traffic encrypted (TLS)
- No open ports except HTTP/HTTPS
- Firewall automatically configured

---

## ğŸ“Š Pricing

### Free Tier
- âœ… Enough for hobby projects
- âœ… 5GB bandwidth monthly
- âœ… Shared compute resources
- âœ… No credit card required

### Pro Tier ($5+/month)
- âœ… Dedicated compute
- âœ… 100GB bandwidth monthly
- âœ… Priority support
- âœ… Custom domains

### Add-ons
- PostgreSQL: $10/month
- MongoDB: $15/month
- Redis: $5/month

---

## ğŸ”— Useful Links

- **Dashboard**: https://railway.app/dashboard
- **Documentation**: https://docs.railway.app
- **Community**: https://community.railway.app
- **Status**: https://railway-status.com

---

## ğŸ¯ Next Steps

1. **Push to GitHub** (if not done)
   ```bash
   git push origin main
   ```

2. **Go to Railway**
   - Visit https://railway.app
   - Sign in with GitHub

3. **Create New Project**
   - Click "Deploy from GitHub"
   - Select termchat-lt

4. **Configure Environment**
   - Add API keys
   - Set variables

5. **Deploy**
   - Click deploy button
   - Wait for green checkmark

6. **Share Your URL**
   - Backend: `https://termchat-xxx.railway.app`
   - Frontend: `https://DaumantasPetrauskas-cloud.github.io/termchat-lt/`

---

## ğŸ“ Support

### Railway Support
- Email: support@railway.app
- Docs: https://docs.railway.app
- Discord: https://discord.gg/railway

### Project Help
- GitHub Issues: Your repo issues tab
- README: Project documentation
- DEPLOY.md: Deployment guide

---

**Status**: âœ… Ready for Railway deployment  
**Dockerfile**: âœ… Configured  
**Configuration**: âœ… Complete  
**Next Step**: Deploy on Railway
